"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[8895],{3905:function(e,t,n){n.d(t,{Zo:function(){return u},kt:function(){return h}});var i=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,i,o=function(e,t){if(null==e)return{};var n,i,o={},a=Object.keys(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=i.createContext({}),p=function(e){var t=i.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},u=function(e){var t=p(e.components);return i.createElement(l.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},c=i.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),c=p(n),h=o,m=c["".concat(l,".").concat(h)]||c[h]||d[h]||a;return n?i.createElement(m,r(r({ref:t},u),{},{components:n})):i.createElement(m,r({ref:t},u))}));function h(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,r=new Array(a);r[0]=c;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:o,r[1]=s;for(var p=2;p<a;p++)r[p]=n[p];return i.createElement.apply(null,r)}return i.createElement.apply(null,n)}c.displayName="MDXCreateElement"},8994:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return s},contentTitle:function(){return l},metadata:function(){return p},toc:function(){return u},default:function(){return c}});var i=n(7462),o=n(3366),a=(n(7294),n(3905)),r=["components"],s={id:"running-tests",slug:"troubleshooting/running-tests",title:"Dealing With Problems With Running Tests",sidebar_label:"Dealing With Problems With Running Tests"},l=void 0,p={unversionedId:"running-tests",id:"running-tests",isDocsHomePage:!1,title:"Dealing With Problems With Running Tests",description:"Dealing With Problems With Running Tests",source:"@site/../docs/Troubleshooting.RunningTests.md",sourceDirName:".",slug:"/troubleshooting/running-tests",permalink:"/Detox/docs/troubleshooting/running-tests",editUrl:"https://github.com/wix/Detox/edit/master/docs/../docs/Troubleshooting.RunningTests.md",tags:[],version:"current",frontMatter:{id:"running-tests",slug:"troubleshooting/running-tests",title:"Dealing With Problems With Running Tests",sidebar_label:"Dealing With Problems With Running Tests"},sidebar:"tutorialSidebar",previous:{title:"Dealing With Problems With Building the App & Detox",permalink:"/Detox/docs/troubleshooting/building-the-app"},next:{title:"Dealing With Synchronization Issues in Tests",permalink:"/Detox/docs/troubleshooting/synchronization"}},u=[{value:"Dealing With Problems With Running Tests",id:"dealing-with-problems-with-running-tests",children:[{value:"Table of Contents",id:"table-of-contents",children:[{value:"Trace Mode",id:"trace-mode",children:[],level:4},{value:"Enable debugging of synchronization issues",id:"enable-debugging-of-synchronization-issues",children:[],level:4},{value:"No simulators found (iOS)",id:"no-simulators-found-ios",children:[],level:4},{value:"Tests execution hangs",id:"tests-execution-hangs",children:[{value:"If you do not see your app running on the device",id:"if-you-do-not-see-your-app-running-on-the-device",children:[],level:5},{value:"If you <em>do</em> see your app running on the device",id:"if-you-do-see-your-app-running-on-the-device",children:[],level:5}],level:4},{value:"Syntax Error: Unexpected Token",id:"syntax-error-unexpected-token",children:[],level:4},{value:"Can\u2019t Find My Component Even Though I Added a <code>testID</code> to Its Props",id:"cant-find-my-component-even-though-i-added-a-testid-to-its-props",children:[],level:4},{value:"Test Tries to Find My Component Before It\u2019s Created",id:"test-tries-to-find-my-component-before-its-created",children:[],level:4},{value:"Can\u2019t synchronize the test with my app",id:"cant-synchronize-the-test-with-my-app",children:[],level:4},{value:"Unknown option &quot;configuration&quot; (Mocha.js)",id:"unknown-option-configuration-mochajs",children:[],level:4},{value:"An Element is Not Visible",id:"an-element-is-not-visible",children:[],level:4},{value:"Debug View Hierarchy",id:"debug-view-hierarchy",children:[],level:4},{value:"Compare to a Working Setup",id:"compare-to-a-working-setup",children:[],level:4},{value:"Take a Look at Past Issues",id:"take-a-look-at-past-issues",children:[],level:4},{value:"How to Open a New Issue",id:"how-to-open-a-new-issue",children:[],level:4}],level:3}],level:2}],d={toc:u};function c(e){var t=e.components,s=(0,o.Z)(e,r);return(0,a.kt)("wrapper",(0,i.Z)({},d,s,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h2",{id:"dealing-with-problems-with-running-tests"},"Dealing With Problems With Running Tests"),(0,a.kt)("p",null,"This page is about issues related to executing your Detox tests, typically triggered when running ",(0,a.kt)("inlineCode",{parentName:"p"},"detox test")," (and not ",(0,a.kt)("inlineCode",{parentName:"p"},"detox build"),", for example)."),(0,a.kt)("p",null,"For troubleshooting of other issue, refer to our ",(0,a.kt)("a",{parentName:"p",href:"/Detox/docs/troubleshooting/troubleshooting"},"troubleshooting index"),"."),(0,a.kt)("h3",{id:"table-of-contents"},"Table of Contents"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"#trace-mode"},"Trace Mode")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"#tests-execution-hangs"},"Tests execution hangs")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"#no-simulators-found-ios"},"No Simulators Found (iOS)")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"#syntax-error-unexpected-token"},"Syntax Error: Unexpected Token")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"#cant-find-my-component-even-though-i-added-a-testid-to-its-props"},"Can\u2019t Find My Component Even Though I Added a ",(0,a.kt)("inlineCode",{parentName:"a"},"testID")," to Its Props")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"#test-tries-to-find-my-component-before-its-created"},"Test Tries to Find My Component Before It\u2019s Created")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"#cant-synchronize-the-test-with-my-app"},"Can\u2019t synchronize the test with my app")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"#unknown-option-configuration-mochajs"},'Unknown option "configuration" (Mocha.js)')),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"#an-element-is-not-visible"},"An Element is Not Visible")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"#debug-view-hierarchy"},"Debug View Hierarchy")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"#compare-to-a-working-setup"},"Compare to a Working Setup")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"#take-a-look-at-past-issues"},"Take a Look at Past Issues")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"#how-to-open-a-new-issue"},"How to Open a New Issue"))),(0,a.kt)("h4",{id:"trace-mode"},"Trace Mode"),(0,a.kt)("p",null,"It\u2019s a good idea to get as much information as possible about what\u2019s going on. We can enable trace mode during tests by running our tests with:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},"detox test --loglevel trace\n")),(0,a.kt)("h4",{id:"enable-debugging-of-synchronization-issues"},"Enable debugging of synchronization issues"),(0,a.kt)("p",null,"See ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/wix/detox/blob/master/docs/Troubleshooting.Synchronization.md#identifying-which-synchronization-mechanism-causes-us-to-wait-too-much"},"here"),"."),(0,a.kt)("h4",{id:"no-simulators-found-ios"},"No simulators found (iOS)"),(0,a.kt)("p",null,"In order to run tests on a simulator, you need to have simulator images installed on your machine. This process is performed by Xcode itself. You can list all available simulators using ",(0,a.kt)("inlineCode",{parentName:"p"},"simctl")," by typing ",(0,a.kt)("inlineCode",{parentName:"p"},"xcrun simctl list")," in terminal."),(0,a.kt)("p",null,"If you\u2019re missing a simulator, make sure Xcode is installed and use it to download the simulator. Take a look at the Preferences screen, some screenshots can be seen ",(0,a.kt)("a",{parentName:"p",href:"http://stackoverflow.com/questions/33738113/how-to-install-ios-9-1-simulator-in-xcode-version-7-1-1-7b1005"},"here"),"."),(0,a.kt)("p",null,"Once the desired simulator is installed and returned by ",(0,a.kt)("inlineCode",{parentName:"p"},"xcrun simctl list"),", double check its name in the list and make sure this name is found in the ",(0,a.kt)("inlineCode",{parentName:"p"},"detox")," configuration entry in ",(0,a.kt)("inlineCode",{parentName:"p"},"package.json"),". The reference for the configuration options is available ",(0,a.kt)("a",{parentName:"p",href:"/Detox/docs/api/configuration"},"here"),"."),(0,a.kt)("h4",{id:"tests-execution-hangs"},"Tests execution hangs"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Issue:")," A while after running Detox, you get a message about failure to connect to the running app, in the logs:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-plain",metastring:"text",text:!0},"Detox can\u2019t seem to connect to the test app(s)!\n")),(0,a.kt)("p",null,"This can be a result of various reasons. It is generally up to you to debug and find the root cause. In any case, below are the common ones."),(0,a.kt)("h5",{id:"if-you-do-not-see-your-app-running-on-the-device"},"If you do not see your app running on the device"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"You might have forgotten to run ",(0,a.kt)("inlineCode",{parentName:"li"},"device.launchApp()")," in the beginning of your test."),(0,a.kt)("li",{parentName:"ul"},"The app might have crashed before Detox has had a chance to connect to it. To get the crash details, you can run Detox tests with ",(0,a.kt)("inlineCode",{parentName:"li"},"--record-logs all")," CLI option and then inspect the device logs in the artifacts folder."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"On Android"),", there might be a problem with the native test code in the ",(0,a.kt)("inlineCode",{parentName:"li"},"DetoxTest.java")," file. Revisit the ",(0,a.kt)("a",{parentName:"li",href:"/Detox/docs/introduction/android#5-create-a-detox-test-class"},"associated section")," in the setup guide.")),(0,a.kt)("h5",{id:"if-you-do-see-your-app-running-on-the-device"},"If you ",(0,a.kt)("em",{parentName:"h5"},"do")," see your app running on the device"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"On Android with SDK\u226528"),", the app\u2019s connection to the Detox test server is blocked due to clear-traffic blockage (as reported in issue ",(0,a.kt)("a",{parentName:"li",href:"https://github.com/wix/Detox/issues/1450"},"#1450"),").\nThe main step for getting this fixed is to revisit the ",(0,a.kt)("a",{parentName:"li",href:"/Detox/docs/introduction/android#6-enable-clear-text-unencrypted-traffic-for-detox"},"associated section")," in the setup guide, which discusses network-security. Alternatively, the ",(0,a.kt)("inlineCode",{parentName:"li"},'android:usesCleartextTraffic="true"')," attribute can be configured in the ",(0,a.kt)("inlineCode",{parentName:"li"},"<application>")," tag of the app\u2019s ",(0,a.kt)("inlineCode",{parentName:"li"},"AndroidManifest.xml"),", but ",(0,a.kt)("strong",{parentName:"li"},"that is highly discouraged"),"."),(0,a.kt)("li",{parentName:"ul"},"If you\u2019ve applied the above suggestion but the app fails to connect to the Detox test server, nonetheless: Refer to the device\u2019s logs, which should contain messages about failed connection attempts (get them using the ",(0,a.kt)("inlineCode",{parentName:"li"},"--record-logs all")," argument)"),(0,a.kt)("li",{parentName:"ul"},"The app could be running without Detox native code injected. In this case, first, make sure you\u2019re not trying to run in manual launch mode (where this behavior is valid). If so, examine the logs from the device (get them using the ",(0,a.kt)("inlineCode",{parentName:"li"},"--record-logs all")," argument). If you see a crash related to Detox\u2019s native code, you are welcome to report it on our GitHub tracker."),(0,a.kt)("li",{parentName:"ul"},"If you are in fact debugging your native code integration with Detox, these guides may prove helpful:",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/wix/Detox/blob/master/docs/Guide.DebuggingInAndroidStudio.md"},"https://github.com/wix/Detox/blob/master/docs/Guide.DebuggingInAndroidStudio.md")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/wix/Detox/blob/master/docs/Guide.DebuggingInXcode.md"},"https://github.com/wix/Detox/blob/master/docs/Guide.DebuggingInXcode.md"))))),(0,a.kt)("h4",{id:"syntax-error-unexpected-token"},"Syntax Error: Unexpected Token"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Issue:")," Running tests immediately throws the following error:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"beforeEach(async () => {\n                   ^\nSyntaxError: Unexpected token (\n    at Object.exports.runInThisContext (vm.js:76:16)\n    at Module._compile (module.js:545:28)\n    at loader (/Users/builduser/buildAgent/work/34eee2d16ef6c34b/node_modules/babel-register/lib/node.js:144:5)\n    at Object.require.extensions.(anonymous function) [as .js] (/Users/builduser/buildAgent/work/34eee2d16ef6c34b/node_modules/babel-register/lib/node.js:154:7)\n...\nchild_process.js:531\n    throw err;\n")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Solution:")," This error means that your version of Node does not support ",(0,a.kt)("inlineCode",{parentName:"p"},"async-await")," syntax. You should do the following:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Update Node to a version ",(0,a.kt)("strong",{parentName:"li"},"8.3.0 or higher"),".")),(0,a.kt)("h4",{id:"cant-find-my-component-even-though-i-added-a-testid-to-its-props"},"Can\u2019t Find My Component Even Though I Added a ",(0,a.kt)("inlineCode",{parentName:"h4"},"testID")," to Its Props"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Issue:")," Detox fails to match a component even though it has a ",(0,a.kt)("inlineCode",{parentName:"p"},"testID"),". Detox will throw the following error:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-plain",metastring:"text",text:!0},'Error: Cannot find UI Element.\nException with Assertion: {\n  "Assertion Criteria" : "assertWithMatcher: matcherForSufficientlyVisible(>=0.750000)",\n  "Element Matcher" : "(((respondsToSelector(accessibilityIdentifier) && accessibilityID(\'Welcome\')) && !kindOfClass(\'RCTScrollView\')) || (kindOfClass(\'UIScrollView\') && ((kindOfClass(\'UIView\') || respondsToSelector(accessibilityContainer)) && ancestorThatMatches(((respondsToSelector(accessibilityIdentifier) && accessibilityID(\'Welcome\')) && kindOfClass(\'RCTScrollView\'))))))",\n  "Recovery Suggestion" : "Check if element exists in the UI, modify assert criteria, or adjust the matcher"\n}\n\nError Trace: [\n  {\n    "Description" : "Interaction cannot continue because the desired element was not found.",\n    "Domain" : "com.google.earlgrey.ElementInteractionErrorDomain",\n    "Code" : "0",\n    "File Name" : "GREYElementInteraction.m",\n    "Function Name" : "-[GREYElementInteraction matchedElementsWithTimeout:error:]",\n    "Line" : "119"\n  }\n]\n')),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Solution:")," React Native only supports the ",(0,a.kt)("inlineCode",{parentName:"p"},"testID")," prop on the native built-in components. If you\u2019ve created a custom composite component, you will have to support this prop yourself. You should probably propagate the ",(0,a.kt)("inlineCode",{parentName:"p"},"testID")," prop to one of your rendered children (a built-in component):"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-jsx"},"export class MyCompositeComponent extends Component {\n  render() {\n    return (\n      <TouchableOpacity testID={this.props.testID}>\n        <View>\n          <Text>Something something</Text>\n        </View>\n      </TouchableOpacity>\n    );\n  }\n}\n")),(0,a.kt)("p",null,"Now, adding ",(0,a.kt)("inlineCode",{parentName:"p"},"testID")," to your composite component should work:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-jsx"},"render() {\n  return <MyCompositeComponent testID='MyUniqueId123' />;\n}\n")),(0,a.kt)("h4",{id:"test-tries-to-find-my-component-before-its-created"},"Test Tries to Find My Component Before It\u2019s Created"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Issue:")," Due to a synchronization issue, the test tries to perform an expectation and fails because it runs the expectation too soon. Consider this example:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"await element(by.text('Login')).tap();\nawait expect(element(by.text('Welcome'))).toBeVisible();\n")),(0,a.kt)("p",null,"In the test above, after tapping the Login button, the app performs several complex asynchronous operations until the Welcome message is displayed post-login. These can include querying a server, waiting for a response and then running an animated transition to the Welcome screen. Detox attempts to simplify your test code by synchronizing ",(0,a.kt)("em",{parentName:"p"},"automatically")," with these asynchronous operations. What happens if for some reason the automatic synchronization doesn\u2019t work? As a result, Detox will not wait correctly until the Welcome screen appears and instead will continue immediately to the next line and try to run the expectation. Since the screen is not there yet, the test will fail."),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Solution:")," When you suspect that automatic synchronization didn\u2019t work, you have a fail-safe by synchronizing manually with ",(0,a.kt)("inlineCode",{parentName:"p"},"waitFor"),". Using ",(0,a.kt)("inlineCode",{parentName:"p"},"waitFor")," will poll until the expectation is met. This isn\u2019t a recommended approach so please use it as a workaround and open and issue to resolve the synchronization issue."),(0,a.kt)("p",null,"This is what the fixed test would look like:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"await element(by.text('Login')).tap();\nawait waitFor(element(by.text('Welcome'))).toBeVisible().withTimeout(2000);\n")),(0,a.kt)("h4",{id:"cant-synchronize-the-test-with-my-app"},"Can\u2019t synchronize the test with my app"),(0,a.kt)("p",null,"If you suspect that the test is failing because Detox fails to synchronize the test steps with your app, take a look at this in-depth ",(0,a.kt)("a",{parentName:"p",href:"/Detox/docs/troubleshooting/synchronization"},"synchronization troubleshooting tutorial"),"."),(0,a.kt)("h4",{id:"unknown-option-configuration-mochajs"},'Unknown option "configuration" (Mocha.js)'),(0,a.kt)("p",null,"In an attempt to run ",(0,a.kt)("inlineCode",{parentName:"p"},"detox test"),", the following error is thrown:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-plain",metastring:"text",text:!0},"detox[4498] INFO:  [test.js] node_modules/.bin/mocha --opts e2e/mocha.opts --configuration ios.sim.release --grep :android: --invert\n\n  error: unknown option `--configuration'\n")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Solution:")," Upgrade to ",(0,a.kt)("inlineCode",{parentName:"p"},"detox@^12.4.0")," or newer (latest, recommended), and ",(0,a.kt)("inlineCode",{parentName:"p"},"mocha@^6.1.3"),".\nThat weird error has been spotted in older versions of ",(0,a.kt)("inlineCode",{parentName:"p"},"mocha")," (including ",(0,a.kt)("inlineCode",{parentName:"p"},"v5.2.0"),") and was fixed in ",(0,a.kt)("inlineCode",{parentName:"p"},"v6.0.0"),". In fact, it conceals the genuine error:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-plain",metastring:"text",text:!0},"Error: No test files found\n")),(0,a.kt)("p",null,"If the error appeared after running a short command like ",(0,a.kt)("inlineCode",{parentName:"p"},"detox test"),", please try out ",(0,a.kt)("inlineCode",{parentName:"p"},"detox test e2e/")," (in other words, append the path to your end-to-end tests folder) - and if that fixes the error, then you deal the bug in the question and upgrading ",(0,a.kt)("inlineCode",{parentName:"p"},"detox")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"mocha")," should help."),(0,a.kt)("p",null,"After you upgrade, you can configure the default path to your end-to-end tests folder in ",(0,a.kt)("inlineCode",{parentName:"p"},"package.json"),":"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-diff"},' {\n   "detox": {\n-    "specs": "",  \n+    "specs": "your-e2e-tests-folder",\n   }\n }\n')),(0,a.kt)("p",null,"Please mind that if your E2E tests are located at the default path (",(0,a.kt)("inlineCode",{parentName:"p"},"e2e"),"), then you don\u2019t need to add ",(0,a.kt)("inlineCode",{parentName:"p"},'"specs"')," property explicitly to ",(0,a.kt)("inlineCode",{parentName:"p"},"package.json"),"."),(0,a.kt)("h4",{id:"an-element-is-not-visible"},"An Element is Not Visible"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"On iOS"),", you may run in a situation, when one of the interactions (tap, scroll, etc.) on an element fails with an error like:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-plain",metastring:"text",text:!0},'Test Failed: View "<RCTScrollView: 0x7f8d32296d70>" is not visible: view does not pass visibility threshold (0% visible of 75% required)\n')),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Try retrieving ",(0,a.kt)("inlineCode",{parentName:"p"},"ui.viewhierarchy")," artifact \u2014 sometimes examining the hierarchy visually can give you insights.\nAdd a line ",(0,a.kt)("inlineCode",{parentName:"p"},'"uiHierarchy": "enabled"')," to your artifacts configuration in ",(0,a.kt)("inlineCode",{parentName:"p"},".detoxrc.js"),", like in an example here: ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/wix/Detox/blob/master/docs/APIRef.Configuration.md#artifacts-configuration"},"Artifacts Configuration"),". After a rerun, you should find\na ",(0,a.kt)("inlineCode",{parentName:"p"},"ui.viewhierarchy")," in a folder of your failing test. Please mind that you need Xcode 12 at least to open ",(0,a.kt)("inlineCode",{parentName:"p"},"*.viewhierarchy")," files.")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Besides, you can rerun your iOS app tests with ",(0,a.kt)("inlineCode",{parentName:"p"},"--take-screenshots failing"),". What will happen is, for each view that fails visibility, two images will be saved at ",(0,a.kt)("inlineCode",{parentName:"p"},"artifacts/<configuration-timestamp-dir>/<test name>/visibilityFailingRects")," (and ",(0,a.kt)("inlineCode",{parentName:"p"},".../visibilityFailingScreenshots")," folder aside) with autogenerated names, e.g. ",(0,a.kt)("inlineCode",{parentName:"p"},"DETOX_VISIBILITY_CustomView_0x7ffe9f50df10_TEST.png"),":"))),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:"center"},"in ",(0,a.kt)("inlineCode",{parentName:"th"},"visibilityFailingScreenshots")),(0,a.kt)("th",{parentName:"tr",align:"center"},"in ",(0,a.kt)("inlineCode",{parentName:"th"},"visibilityFailingRects")))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:"center"},(0,a.kt)("img",{alt:"visible",src:"https://user-images.githubusercontent.com/2270433/94178906-68872380-fea4-11ea-845c-c55c25b68c0e.png",height:"480"})),(0,a.kt)("td",{parentName:"tr",align:"center"},(0,a.kt)("img",{alt:"internals",src:"https://user-images.githubusercontent.com/2270433/94178919-6c1aaa80-fea4-11ea-8db6-64f1f4b21361.png",height:"480"}))))),(0,a.kt)("p",null,"The first is supposed to show what is seen on screen. The second shows the internal buffer that Detox tests for visibility; if the pixels aren\u2019t transparent enough and less than 75% of tested region is not transparent, the view is not considered visible."),(0,a.kt)("p",null,"If you are developing a React Native app, then the following applies. If, for instance, you see that tapping fails due to a view with ",(0,a.kt)("inlineCode",{parentName:"p"},'pointerEvents="none"')," obscuring your target \u2014 well, the only solutions are: either to make the obscurer a descendant of your target (instead of being a sibling), or to tap on the parent container."),(0,a.kt)("p",null,"If you see that your issue cannot be solved via testID replacement or a simple hierarchy rearrangement, then there\u2019s a chance this is a bug in Detox. Make sure to provide your ",(0,a.kt)("inlineCode",{parentName:"p"},"ui.viewhierarchy")," artifact, the pictures generated under ",(0,a.kt)("inlineCode",{parentName:"p"},"visibilityFailingRects")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"visibilityFailingScreenshots")," folders and a comprehensive description of the issue backed up with sound arguments."),(0,a.kt)("h4",{id:"debug-view-hierarchy"},"Debug View Hierarchy"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Issue:")," I added the ",(0,a.kt)("inlineCode",{parentName:"p"},"testID")," prop but I still can\u2019t find the view by id in my tests."),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Solution:")," You can investigate the app\u2019s native view hierarchy, this might shed some light on how the app\u2019s view hierarchy is laid out."),(0,a.kt)("p",null,"Do the following:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Start a debuggable app (not a release build) in your simulator"),(0,a.kt)("li",{parentName:"ol"},"Open Xcode"),(0,a.kt)("li",{parentName:"ol"},"Attach Xcode to your app\u2019s process\n",(0,a.kt)("img",{alt:"attach to process",src:n(1618).Z})),(0,a.kt)("li",{parentName:"ol"},"Press the ",(0,a.kt)("inlineCode",{parentName:"li"},"Debug View Hierarchy")," button\n",(0,a.kt)("img",{alt:"debug view hierarchy",src:n(9794).Z})),(0,a.kt)("li",{parentName:"ol"},"This will open the hierarchy viewer, and will show a breakdown of your app\u2019s native view hierarchy. Here you can browse through the views"),(0,a.kt)("li",{parentName:"ol"},"React Native testIDs are manifested as ",(0,a.kt)("em",{parentName:"li"},"accessibility identifiers")," in the native view hierarchy")),(0,a.kt)("p",null,"Let\u2019s see an example. We will find the following view in the native hierarchy:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-jsx"},"<TouchableOpacity onPress={this.onButtonPress.bind(this, 'ID Working')}>\n  <Text testID='UniqueId345' style={{color: 'blue', marginBottom: 20}}>ID</Text>\n</TouchableOpacity>\n")),(0,a.kt)("p",null,"This is the hierarchy viewer, pointing to the native view just mentioned:"),(0,a.kt)("img",{src:"img/hierarchy-viewer.jpg"}),(0,a.kt)("h4",{id:"compare-to-a-working-setup"},"Compare to a Working Setup"),(0,a.kt)("p",null,"If you feel lost, try starting from a working example for sanity."),(0,a.kt)("p",null,"There are multiple working examples included in this repo, such as ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/wix/Detox/tree/master/examples/demo-react-native"},"demo-react-native"),"."),(0,a.kt)("p",null,"First, install, build and make sure the tests are indeed passing. If they are, try comparing this setup with what you have."),(0,a.kt)("h4",{id:"take-a-look-at-past-issues"},"Take a Look at Past Issues"),(0,a.kt)("p",null,"Before opening a new issue, search the ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/wix/detox/issues?utf8=%E2%9C%93%5C&q=is%3Aissue"},"list of issues")," on GitHub. There\u2019s a good chance somebody faced the same problem you are having."),(0,a.kt)("h4",{id:"how-to-open-a-new-issue"},"How to Open a New Issue"),(0,a.kt)("p",null,"Before opening a new issue, please follow the entire troubleshooting guide and go over past issues."),(0,a.kt)("p",null,"General usage questions should be opened on Stack Overflow, where the core Detox team is active and responds to questions:\n",(0,a.kt)("a",{parentName:"p",href:"https://stackoverflow.com/questions/tagged/detox"},"https://stackoverflow.com/questions/tagged/detox")),(0,a.kt)("p",null,"If you believe you are seeing a Detox issue, select the correct template from the options, and make sure to fill all requested information in the template. Omitting important information will likely result in a closed issue."))}c.isMDXComponent=!0},1618:function(e,t,n){t.Z=n.p+"assets/images/attach-to-process-e47ced58650b9d7733142a3302fa2a35.jpg"},9794:function(e,t,n){t.Z=n.p+"assets/images/debug-view-hierarchy-c086dcbfdc42ee69b1e1043bbe89271d.jpg"}}]);